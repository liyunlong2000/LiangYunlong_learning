# 浮点数
## 二进制小数
- 表示：小数点左边的权重从低位到高位为1,2，...,2^(w-1)，小数点右边的权重从左到右为1/2，...,1/2^(j-1)
- 局限性：
    - 只能表示具有x/2^k形式的数，其它有理数需要循环的比特位表示
    - w位比特中小数点位置限制了数的范围
## IEEE 浮点数标准
### 浮点数表示
- 数值形式：(-1)^s * M * 2^E
    - s为符号位
    - M为尾数，通常为[1.0,2.0)之间的小数
    - E为指数
- 编码：分为三个区域
    - s：表示符号位
    - exp：表示E，但是不等同E
    - frac：表示M，但是不等同M
### 精度
- 单精度32位：
    - s：1位
    - exp：8位
    - frac：23位
- 双精度64位：
    - s：1位
    - exp：11位
    - frac：52位
- 扩展精度80位(Intel)：
    - s：1位
    - exp：15位
    - frac：63位 or 64位
### 标准化小数
- exp $\neq$ 00...0 且 $\neq$ 11...1
- 指数部分编码为：E=Exp-Bias
    - Exp：exp域中无符号数
    - Bias：$2^{k-1}-1$,其中k为exp域比特数
        - 单精度：E：-126...127
        - 双精度：E：-1022...1023
- 尾数部分编码：隐含了1，M=1.xxxxx
    - xxxxx为frac域中比特
    - 范围：1...2-$\epsilon$

**TODO:加入标准化小数编码例子**

### 非标准化小数
- exp = 00...0 
    - 因为标准化小数中M为[1.0,2.0)，无法表示趋于0的小数
- 指数部分编码为：E=1-Bias
    - Bias：$2^{k-1}-1$,其中k为exp域比特数
- 尾数部分编码：不隐含1，M=0.xxxxx
    - xxxxx为frac域中比特
- Cases：
    - exp = 00...0 ，frac = 00...0 
        - 表示0，有正负0之分
    - exp = 00...0 ，frac $\neq$ 00...0 
        - 表示趋于0的小数
### 特殊值
既不是标准化小数，也不是非标准化小数
-  exp = 11...1 ，frac = 00...0 
    - 表示无穷$\infty$，有正负无穷之分
- exp = 11...1 ，frac $\neq$ 00...0 
    - 表示NaN(not-a-num)，用来表示无法表示的数，例如：sqrt(-1),$\infty$-$\infty$
### 浮点数编码
**浮点数范围图**

## 例子和性质
### 浮点数例子
采用IEEE标准表示，s占1位，exp占4位，frac占3位
**浮点数例子范围图**
- 当exp=0时，表示非标准化小数，其表示趋于0的小数部分。当exp不为0时，表示标准化小数。
- 标准化小数和非标准化小数中E的设置使两者之间过渡平滑
- 指数相同时，表示的值间距相同。指数越大，表示的值间距越大。指数越小，表示的值间距越小。
### 性质
- 当浮点数比特全0时，和整数0相同
- 能够比较浮点数通过无符号整数
    - 除了NaN之外
## 进位、加法、乘法
### 基本思想
- 浮点数操作基本思想：
    1. 计算准确的结果
    2. 通过舍入调整到期望的精度
        - 当exp过大时，exp=1...1，溢出到无穷$\infty$
### 进位
分为以下的几种进位模式：
- 向0进位
- 向下进位
- 向上进位
- 向最近的偶数进位
    - 即四舍六入五留双
    - 默认的进位模式
### 浮点数数进位例子

**二进制数进位例子图**
### 浮点数乘法
**二进制浮点数乘法例子图**

浮点数乘法法数学性质：
1. 具有交换律
2. 不具有结合律
    - 会出现大数吃小数的情况
3. 浮点数一般都有逆元(除无穷和NaN)
4. 一般具有单调性(除无穷和NaN)
### 浮点数加法
**二进制浮点数加法例子图**

浮点数加法数学性质：
1. 具有交换律
2. 不具有结合律
    - 会出现大数吃小数的情况
3. 浮点数一般都有逆元(除无穷和NaN)
4. 一般具有单调性(除无穷和NaN)
## C中浮点数
### C语言中浮点类型
- float：单精度32位(1,8,23)
- double：双精度64位(1,11,52)
### 类型转换
- double/float->int
    - 截断小数部分
    - NaN、无穷通常设为Tmin
- int->double
    - 能够准确转换，因为int类型位数小于double尾数部分位数(32<53)
- int->float
    - 不能准确转换，因为int类型位数大于float尾数部分位数(32>23),会根据进位模式进行进位
### 浮点数练习题
**浮点数练习题图**
1. false：不能准确转换
2. true：能够准确转换
3. true：double的位数大于float的位数，能够准确转换
4. false：double的位数大于float的位数，不能够准确转换
5. true：题中排除了NaN和无穷，每个浮点数都有对应的相反数
6. false：左边为0，右边为不为0的浮点数
7. true：即使溢出仍是负无穷
8. true：具有单调性
9. true：一定大于0
10. false：不具有结合律